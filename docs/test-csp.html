<!DOCTYPE html>
<html>
<head>
    <title>CSP Test</title>
</head>
<body>
    <h1>Content Security Policy Test</h1>
    <p>This page is for testing CSP headers.</p>
    
    <script>
        // Test if we can connect to Supabase using env-provided anon key
        const anonKey = window.__ENV__?.SUPABASE_ANON_KEY;
        if (!anonKey) {
            document.body.innerHTML += '<p style="color: orange;">⚠️ Missing SUPABASE_ANON_KEY in window.__ENV__. Supabase calls are disabled.</p>';
        } else {
            fetch('https://uimdbodamoeyukrghchb.supabase.co/rest/v1/courses?select=id,title&limit=1', {
                method: 'GET',
                headers: {
                    'apikey': anonKey,
                    'Authorization': 'Bearer ' + anonKey
                }
            })
            .then(response => {
                if (response.ok) {
                    return response.json();
                }
                throw new Error('Network response was not ok');
            })
            .then(data => {
                document.body.innerHTML += '<p style="color: green;">✅ Successfully connected to Supabase!</p>';
                console.log('Data:', data);
            })
            .catch(error => {
                document.body.innerHTML += '<p style="color: red;">❌ Failed to connect to Supabase: ' + error.message + '</p>';
                console.error('Error:', error);
            });
        }
    </script>
</body>
</html>